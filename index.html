<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA Encryption & Digital Signature</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h2 class="text-center mt-4">RSA Encryption & Digital Signature</h2>

        <!-- Key Generation -->
        <section>
            <h4>1. Generate RSA Key Pairs</h4>
            <button class="btn btn-primary" onclick="generateKeys()">Generate Keys</button>
            <textarea id="keysOutput" class="form-control mt-2" rows="4" readonly></textarea>
        </section>

        <!-- Encryption & Decryption -->
        <section>
            <h4>2. Encryption (RSA)</h4>
            <textarea id="encryptMessage" class="form-control" rows="3" placeholder="Enter message to encrypt"></textarea>
            <button class="btn btn-success mt-2" onclick="encryptMessage()">Encrypt with Public Key (B)</button>
            <textarea id="encryptOutput" class="form-control mt-2" rows="3" readonly></textarea>

            <h4> Decryption (RSA)</h4>
            <textarea id="decryptInput" class="form-control mt-2" rows="3" placeholder="Enter encrypted message"></textarea>
            <button class="btn btn-warning mt-2" onclick="decryptMessage()">Decrypt with Private Key (B)</button>
            <textarea id="decryptOutput" class="form-control mt-2" rows="3" readonly></textarea>
        </section>

        <!-- Digital Signature -->
        <section>
            <h4>3. Digital Signature (RSA)</h4>
            <textarea id="signMessage" class="form-control" rows="3" placeholder="Enter message to sign"></textarea>
            <button class="btn btn-info mt-2" onclick="signMessage()">Sign with Private Key (A)</button>
            <textarea id="signOutput" class="form-control mt-2" rows="3" readonly></textarea>

            <h4>Verify with Public Key (A)</h4>
            <textarea id="verifyMessage" class="form-control mt-2" rows="3" placeholder="Enter original message"></textarea>
            <textarea id="verifySignature" class="form-control mt-2" rows="3" placeholder="Enter signature"></textarea>
            <button class="btn btn-danger mt-2" onclick="verifySignature()">Verify with Public Key (A)</button>
            <textarea id="verifyOutput" class="form-control mt-2" rows="3" readonly></textarea>
        </section>

        <!-- Signed & Encrypted Message -->
        <section>
            <h4>4. Signed & Encrypted Message</h4>
            <textarea id="signedEncryptedMessage" class="form-control" rows="3" placeholder="Enter message"></textarea>
            <button class="btn btn-dark mt-2" onclick="signAndEncrypt()">Sign & Encrypt</button>
            <textarea id="signedEncryptedOutput" class="form-control mt-2" rows="3" readonly></textarea>

            <h4>Decrypt & Verify Message</h4>
            <textarea id="originalMessageForVerification" class="form-control mt-2" rows="3" placeholder="Enter original message"></textarea>
            <textarea id="decryptAndVerifyInput" class="form-control mt-2" rows="3" placeholder="Enter signed & encrypted message"></textarea>
            <button class="btn btn-dark mt-2" onclick="decryptAndVerify()">Decrypt & Verify</button>
            <textarea id="decryptAndVerifyOutput" class="form-control mt-2" rows="3" readonly></textarea>
        </section>
    </div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.2.1/jsencrypt.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
	<script src="function.js"></script>
</body>
</html>
